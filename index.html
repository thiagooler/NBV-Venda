<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>NBV Admin - Master V12</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="database.js"></script>

    <style>
        :root { --primary: #0066cc; --bg: #f3f4f6; --sidebar: #fff; --text: #1f2937; --border: #e5e7eb; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* SIDEBAR */
        .sidebar { width: 280px; background: var(--sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .nav-btn { width: 100%; text-align: left; padding: 12px; margin-bottom: 5px; cursor: pointer; border: none; background: none; color: #666; font-weight: 600; display: flex; align-items: center; gap: 10px; border-radius: 6px; }
        .nav-btn:hover, .nav-btn.active { background: #eff6ff; color: var(--primary); }
        .nav-btn.active { font-weight: 700; border-right: 3px solid var(--primary); }

        /* CONTENT */
        .main-content { flex: 1; padding: 30px; overflow-y: auto; }
        .section { display: none; animation: fadeIn 0.3s; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity:0; transform:translateY(5px); } to { opacity:1; transform:translateY(0); } }

        /* FORMS */
        .form-group { margin-bottom: 15px; }
        label { display: block; font-weight: 600; margin-bottom: 5px; font-size: 0.85rem; color:#555; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-family: inherit; font-size: 0.9rem; }
        .row { display: flex; gap: 15px; } 
        .col { flex: 1; }

        /* TABLES & LISTS */
        .list-item, .table-row { background: #fff; padding: 10px; border: 1px solid #eee; border-radius: 6px; margin-bottom: 5px; display:flex; align-items:center; gap:10px; }
        .btn-remove { background: #fee2e2; color: #dc2626; border: none; width: 30px; height: 30px; border-radius: 4px; cursor: pointer; font-weight:bold; }
        
        /* BUTTONS */
        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; color: white; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.9rem; transition:0.2s }
        .btn:hover { opacity: 0.9; transform: scale(0.99); }
        .btn-primary { background: var(--primary); }
        .btn-success { background: #10b981; }
        .btn-dark { background: #1f2937; }
        .btn-add { background: #ecfdf5; color: #10b981; border: 1px dashed #10b981; }
        
        /* Header & Status */
        .header-title { margin:0 0 20px; font-size:1.4rem; color:#333; display:flex; align-items:center; gap:10px; font-weight:800 }
        .status-bar { padding:15px; border-radius:8px; margin-bottom:20px; font-weight:bold; display:none; }
        .status-success { background:#dcfce7; color:#166534; border:1px solid #bbf7d0; }
        .status-error { background:#fee2e2; color:#991b1b; border:1px solid #fecaca; }
        .status-loading { background:#e0f2fe; color:#075985; border:1px solid #bae6fd; }

        /* Github Box */
        .gh-config { background: #f1f5f9; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; margin-bottom: 20px; font-size: 0.85rem; }
        .gh-config input { padding: 6px; font-size: 0.8rem; margin-bottom: 5px; border:1px solid #cbd5e1 }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="header-title"><i class="fas fa-camera"></i> Studio<span style="color:var(--primary)">NBV</span></div>
        
        <div class="gh-config">
            <label><i class="fab fa-github"></i> Conex√£o GitHub</label>
            <input type="password" id="ghToken" placeholder="Token (ghp_...)">
            <input type="text" id="ghUser" placeholder="Usu√°rio GitHub">
            <input type="text" id="ghRepo" placeholder="Reposit√≥rio">
            <input type="text" id="ghBranch" placeholder="Branch (main)" value="main">
            <button class="btn btn-dark" style="padding:8px; font-size:0.8rem; margin-top:5px" onclick="salvarCredenciaisLocal()">
                <i class="fas fa-save"></i> Salvar Acesso
            </button>
        </div>

        <nav>
            <button class="nav-btn active" onclick="showTab('tab-cliente')"><i class="fas fa-user-plus"></i> Novo Cliente</button>
            <button class="nav-btn" onclick="showTab('tab-fotolivros')"><i class="fas fa-book"></i> Tabela Fotolivros</button>
            <button class="nav-btn" onclick="showTab('tab-produtos')"><i class="fas fa-images"></i> Produtos Avulsos</button>
            <button class="nav-btn" onclick="showTab('tab-financeiro')"><i class="fas fa-coins"></i> Finan. & Log√≠stica</button>
            <button class="nav-btn" onclick="showTab('tab-config')"><i class="fas fa-cogs"></i> Configs Gerais</button>
        </nav>

        <div style="margin-top:auto">
            <button class="btn btn-primary" onclick="salvarDatabaseGlobal()"><i class="fas fa-cloud-upload-alt"></i> SALVAR DB GLOBAL</button>
            <small style="display:block; text-align:center; margin-top:5px; color:#666; font-size:0.7rem">Atualiza pre√ßos e produtos para todos.</small>
        </div>
    </div>

    <div class="main-content">
        <div id="status-display" class="status-bar"></div>

        <div id="tab-cliente" class="section active">
            <h2><i class="fas fa-user-plus"></i> Gerar Link do Cliente</h2>
            <div style="background:white; padding:25px; border-radius:8px; border:1px solid #e5e7eb; box-shadow: 0 1px 3px rgba(0,0,0,0.05)">
                
                <div class="row">
                    <div class="col">
                        <label>Nome do Cliente (Nome da Pasta)</label>
                        <input type="text" id="cliNome" placeholder="Ex: Casamento_Maria_Joao">
                        <small style="color:#666; font-size:0.75rem">Evite espa√ßos e acentos no nome da pasta.</small>
                    </div>
                    <div class="col">
                        <label>Objetivo do Link</label>
                        <select id="fluxoModo">
                            <option value="venda">üí∞ Venda Completa (Edi√ß√£o + Produtos)</option>
                            <option value="aprovacao">‚úÖ Apenas Aprova√ß√£o (Sem Venda)</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" style="margin-top:15px">
                    <label>Links das Fotos (Uma URL por linha)</label>
                    <textarea id="cliFotos" rows="6" placeholder="https://dominio.com/foto1.jpg&#10;https://dominio.com/foto2.jpg"></textarea>
                </div>

                <div style="background:#f8fafc; padding:20px; border-radius:8px; margin-top:20px; border:1px solid #e2e8f0">
                    <h4 style="margin:0 0 15px; color:#0f172a; border-bottom:1px solid #cbd5e1; padding-bottom:5px">Financeiro Espec√≠fico deste Cliente</h4>
                    
                    <div class="row">
                        <div class="col">
                            <label>Entrada J√° Paga (R$)</label>
                            <input type="number" id="cliEntrada" value="0.00">
                        </div>
                        <div class="col">
                            <label>Possui Contrato de √Ålbum?</label>
                            <select id="cliTemAlbum" onchange="toggleContrato()">
                                <option value="nao">N√£o (Venda Avulsa)</option>
                                <option value="sim">Sim (J√° incluso no pacote)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="area-contrato" style="display:none; margin-top:15px; background:#eff6ff; padding:15px; border-radius:6px; border:1px solid #bfdbfe">
                        <div class="row">
                            <div class="col"><label>Tamanho Contratado</label><select id="ctrTam"><option value="15x20">15x20</option><option value="20x30">20x30</option><option value="30x40">30x40</option></select></div>
                            <div class="col"><label>Qtd. Fotos</label><input type="number" id="ctrQtd" value="20"></div>
                            <div class="col"><label>Valor Total do Pacote (R$)</label><input type="number" id="ctrValor" value="0.00"></div>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top:15px">
                        <label>Brindes / Cr√©ditos Espec√≠ficos</label>
                        <div id="creditos-list"></div>
                        <button class="btn btn-add" style="margin-top:5px; padding:8px; font-size:0.8rem" onclick="addCreditoRow()">+ Adicionar Brinde</button>
                    </div>
                </div>

                <button class="btn btn-success" style="margin-top:25px; font-size:1.1rem; height:50px" onclick="publicarCliente()">
                    <i class="fas fa-rocket"></i> GERAR E PUBLICAR SITE
                </button>
            </div>
        </div>

        <div id="tab-fotolivros" class="section">
            <div style="display:flex; justify-content:space-between; align-items:center">
                <h2><i class="fas fa-book"></i> Tabela de Fotolivros</h2>
            </div>
            
            <div style="background:white; padding:20px; border-radius:8px; margin-bottom:20px; border:1px solid #eee">
                <div class="row">
                    <div class="col"><label>Markup (Multiplicador)</label><input type="number" id="confMarkup" step="0.1"></div>
                    <div class="col"><label>Custo Diag. (Fixo)</label><input type="number" id="confCustoFixo"></div>
                    <div class="col"><label>M√≠nimo Fotos</label><input type="number" id="confMinFotos"></div>
                </div>
            </div>
            
            <h4 style="margin-top:20px">Custos de Laborat√≥rio (Base para C√°lculo)</h4>
            <div id="fotolivro-table"></div>
            <button class="btn btn-add" onclick="addBookRow()">+ Nova Linha</button>

            <h4 style="margin-top:20px">Regras de Diagrama√ß√£o (Fotos/P√°g)</h4>
            <div id="regras-container" style="display:flex; gap:20px; flex-wrap:wrap"></div>
        </div>

        <div id="tab-produtos" class="section">
            <h2><i class="fas fa-images"></i> Produtos Avulsos</h2>
            <div id="produtos-list"></div>
            <button class="btn btn-add" onclick="addProdRow()">+ Novo Produto</button>
        </div>

        <div id="tab-financeiro" class="section">
            <h2><i class="fas fa-coins"></i> Financeiro & Log√≠stica</h2>
            <div style="background:white; padding:20px; border-radius:8px; border:1px solid #eee">
                <div class="row">
                    <div class="col"><label>WhatsApp (Somente n√∫meros)</label><input type="text" id="confWhats"></div>
                    <div class="col"><label>Desconto Pix (%)</label><input type="number" id="confPix"></div>
                </div>
                <div class="form-group"><label>Tabela de Juros (Separado por v√≠rgula)</label><input type="text" id="confJuros"></div>
                
                <hr style="margin:20px 0; border:0; border-top:1px solid #eee">
                
                <div class="row">
                    <div class="col"><label>Taxa de Envio Transportadora (R$)</label><input type="number" id="confFreteValor"></div>
                    <div class="col"><label>Cidades com Frete Gr√°tis</label><input type="text" id="confFreteCidades"></div>
                </div>
                <div class="form-group"><label>Endere√ßo da Sede (Retirada)</label><input type="text" id="confSede"></div>
            </div>
        </div>

        <div id="tab-config" class="section">
            <h2><i class="fas fa-cogs"></i> Configura√ß√µes Gerais</h2>
            <div style="background:white; padding:20px; border-radius:8px; border:1px solid #eee">
                <div class="form-group"><label>Texto Marca D'√°gua</label><input type="text" id="confWmText"></div>
                <div class="form-group"><label>Opacidade Marca D'√°gua (0.1 a 1.0)</label><input type="number" id="confWmOp" step="0.1"></div>
            </div>
        </div>

    </div>

<script>
    // --- L√ìGICA DO SISTEMA ---

    window.onload = function() {
        carregarCredenciaisLocal();
        // Carrega DB se existir, sen√£o avisa
        if(window.NBV_DB) {
            carregarDadosNaTela(window.NBV_DB);
        } else {
            showStatus("Aviso: database.js n√£o encontrado ou vazio.", "error");
        }
    };

    // Tabs
    function showTab(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // Toggle Contrato UI
    function toggleContrato() {
        const val = document.getElementById('cliTemAlbum').value;
        document.getElementById('area-contrato').style.display = (val === 'sim') ? 'block' : 'none';
    }

    // Status UI
    function showStatus(msg, type='loading', persist=false) {
        const el = document.getElementById('status-display');
        el.className = 'status-bar status-' + type;
        el.innerHTML = msg; // Permite HTML (links)
        el.style.display = 'block';
        if(!persist && type !== 'loading') {
            setTimeout(() => el.style.display = 'none', 8000);
        }
    }

    // --- CARREGAMENTO TELA (DB -> Inputs) ---
    function carregarDadosNaTela(db) {
        // Finan
        document.getElementById('confMarkup').value = db.financeiro.markup;
        document.getElementById('confCustoFixo').value = db.financeiro.custoFixoDiagramacao;
        document.getElementById('confMinFotos').value = db.fluxo.minimoFotosLivro;
        document.getElementById('confWhats').value = db.financeiro.whatsapp;
        document.getElementById('confPix').value = db.financeiro.descontoPix;
        document.getElementById('confJuros').value = db.financeiro.tabelaJuros.join(', ');
        // Log
        document.getElementById('confFreteValor').value = db.logistica.taxaEnvio;
        document.getElementById('confFreteCidades').value = db.logistica.cidadesGratis.join(', ');
        document.getElementById('confSede').value = db.logistica.enderecoSede;
        // Assets
        document.getElementById('confWmText').value = db.assets.watermarkText;
        document.getElementById('confWmOp').value = db.assets.opacity;
        // Tabelas
        renderBooks(db.tabelaFotolivros);
        renderProds(db.produtosAvulsos);
        renderRegras(db.regrasDiagramacao);
    }

    function renderBooks(list) {
        const el = document.getElementById('fotolivro-table');
        el.innerHTML = '';
        list.forEach(item => addBookRow(item));
    }
    function addBookRow(item = {}) {
        const html = `
        <div class="table-row book-row">
            <select class="bk-size" style="width:100px"><option ${item.size=='15x20'?'selected':''}>15x20</option><option ${item.size=='20x30'?'selected':''}>20x30</option><option ${item.size=='30x40'?'selected':''}>30x40</option></select>
            <input type="number" class="bk-pages" value="${item.pages||''}" placeholder="P√°gs" style="width:80px">
            <input type="number" class="bk-price" value="${item.price||''}" placeholder="R$ Base">
            <input type="number" class="bk-box" value="${item.priceBox||''}" placeholder="R$ Com Caixa">
            <button class="btn-remove" onclick="this.parentElement.remove()"><i class="fas fa-trash"></i></button>
        </div>`;
        document.getElementById('fotolivro-table').insertAdjacentHTML('beforeend', html);
    }

    function renderProds(list) {
        const el = document.getElementById('produtos-list');
        el.innerHTML = '';
        list.forEach(item => addProdRow(item));
    }
    function addProdRow(item = {}) {
        const html = `
        <div class="list-item prod-row">
            <input type="text" class="pd-name" value="${item.nome||''}" placeholder="Nome Produto" style="flex:2">
            <input type="number" class="pd-price" value="${item.preco||''}" placeholder="Pre√ßo Venda" style="flex:1">
            <input type="text" class="pd-icon" value="${item.icone||'fas fa-image'}" placeholder="Icone (fa)" style="flex:1">
            <button class="btn-remove" onclick="this.parentElement.remove()"><i class="fas fa-trash"></i></button>
        </div>`;
        document.getElementById('produtos-list').insertAdjacentHTML('beforeend', html);
    }

    function renderRegras(regras) {
        const el = document.getElementById('regras-container');
        el.innerHTML = '';
        for(let key in regras) {
            el.innerHTML += `<div><label>${key}</label><input type="number" class="regra-item" data-key="${key}" value="${regras[key]}" style="width:80px"></div>`;
        }
    }

    function addCreditoRow() {
        let opts = '<option value="">-- Selecione --</option>';
        document.querySelectorAll('.prod-row .pd-name').forEach(i => { if(i.value) opts += `<option value="${i.value}">${i.value}</option>`; });
        const html = `
        <div class="list-item cred-row">
            <select class="cr-item" style="flex:2">${opts}</select>
            <input type="number" class="cr-qtd" value="1" style="width:80px" placeholder="Qtd">
            <button class="btn-remove" onclick="this.parentElement.remove()">X</button>
        </div>`;
        document.getElementById('creditos-list').insertAdjacentHTML('beforeend', html);
    }

    // --- MONTAGEM DO OBJETO JS (TELA -> JSON) ---
    function montarObjetoDB() {
        const livros = [];
        document.querySelectorAll('.book-row').forEach(r => {
            livros.push({
                size: r.querySelector('.bk-size').value,
                pages: parseInt(r.querySelector('.bk-pages').value),
                price: parseFloat(r.querySelector('.bk-price').value),
                priceBox: parseFloat(r.querySelector('.bk-box').value)
            });
        });

        const produtos = [];
        document.querySelectorAll('.prod-row').forEach(r => {
            produtos.push({
                nome: r.querySelector('.pd-name').value,
                preco: parseFloat(r.querySelector('.pd-price').value),
                icone: r.querySelector('.pd-icon').value
            });
        });

        const regras = {};
        document.querySelectorAll('.regra-item').forEach(r => {
            regras[r.dataset.key] = parseInt(r.value);
        });

        return {
            assets: {
                watermarkText: document.getElementById('confWmText').value,
                opacity: parseFloat(document.getElementById('confWmOp').value)
            },
            fluxo: {
                pedirEdicao: true,
                pedirAprovacao: true,
                minimoFotosLivro: parseInt(document.getElementById('confMinFotos').value)
            },
            logistica: {
                taxaEnvio: parseFloat(document.getElementById('confFreteValor').value),
                cidadesGratis: document.getElementById('confFreteCidades').value.split(',').map(s=>s.trim()),
                enderecoSede: document.getElementById('confSede').value
            },
            financeiro: {
                descontoPix: parseFloat(document.getElementById('confPix').value),
                parcelasSemJuros: 4,
                tabelaJuros: document.getElementById('confJuros').value.split(',').map(Number),
                whatsapp: document.getElementById('confWhats').value,
                markup: parseFloat(document.getElementById('confMarkup').value),
                custoFixoDiagramacao: parseFloat(document.getElementById('confCustoFixo').value)
            },
            produtosAvulsos: produtos,
            tabelaFotolivros: livros,
            regrasDiagramacao: regras
        };
    }

    // --- GITHUB API (CORE) ---

    function getGhCreds() {
        const t = document.getElementById('ghToken').value;
        const u = document.getElementById('ghUser').value;
        const r = document.getElementById('ghRepo').value;
        const b = document.getElementById('ghBranch').value || 'main';
        if(!t || !u || !r) return null;
        return { token: t, user: u, repo: r, branch: b };
    }

    function salvarCredenciaisLocal() {
        const c = getGhCreds();
        if(!c) return alert("Preencha todos os campos!");
        localStorage.setItem('nbv_gh_token', c.token);
        localStorage.setItem('nbv_gh_user', c.user);
        localStorage.setItem('nbv_gh_repo', c.repo);
        localStorage.setItem('nbv_gh_branch', c.branch);
        alert("Acesso Salvo!");
    }

    function carregarCredenciaisLocal() {
        if(localStorage.getItem('nbv_gh_token')) document.getElementById('ghToken').value = localStorage.getItem('nbv_gh_token');
        if(localStorage.getItem('nbv_gh_user')) document.getElementById('ghUser').value = localStorage.getItem('nbv_gh_user');
        if(localStorage.getItem('nbv_gh_repo')) document.getElementById('ghRepo').value = localStorage.getItem('nbv_gh_repo');
        if(localStorage.getItem('nbv_gh_branch')) document.getElementById('ghBranch').value = localStorage.getItem('nbv_gh_branch');
    }

    // 1. UPLOAD GEN√âRICO
    async function uploadToGithub(creds, path, contentStr, message) {
        const apiUrl = `https://api.github.com/repos/${creds.user}/${creds.repo}/contents/${path}`;
        
        // 1. Verifica SHA (Update)
        let sha = null;
        try {
            const check = await fetch(apiUrl + `?ref=${creds.branch}`, { headers: { Authorization: `token ${creds.token}` } });
            if(check.ok) {
                const data = await check.json();
                sha = data.sha;
            }
        } catch(e) {}

        // 2. Envia PUT
        const body = {
            message: message,
            content: btoa(unescape(encodeURIComponent(contentStr))),
            branch: creds.branch
        };
        if(sha) body.sha = sha;

        const res = await fetch(apiUrl, {
            method: 'PUT',
            headers: { 
                'Authorization': `token ${creds.token}`, 
                'Content-Type': 'application/json' 
            },
            body: JSON.stringify(body)
        });

        if(!res.ok) {
            const err = await res.json();
            throw new Error(`GitHub Erro ${res.status}: ${err.message}`);
        }
        return `https://${creds.user}.github.io/${creds.repo}/${path}`;
    }

    // 2. SALVAR DATABASE (Bot√£o Sidebar)
    async function salvarDatabaseGlobal() {
        const creds = getGhCreds();
        if(!creds) return alert("Configure o GitHub primeiro!");
        
        showStatus("‚è≥ Salvando database.js no GitHub...", "loading");

        try {
            const dbObj = montarObjetoDB();
            const content = `window.NBV_DB = ${JSON.stringify(dbObj, null, 4)};`;
            
            await uploadToGithub(creds, 'database.js', content, "Atualiza√ß√£o Global Admin");
            
            window.NBV_DB = dbObj; // Atualiza RAM
            showStatus("‚úÖ Configura√ß√µes salvas com sucesso!", "success");
        } catch(e) {
            console.error(e);
            showStatus("‚ùå Erro ao salvar: " + e.message, "error");
        }
    }

    // 3. PUBLICAR CLIENTE
    async function publicarCliente() {
        const creds = getGhCreds();
        const nome = document.getElementById('cliNome').value.trim();
        if(!creds || !nome) return alert("Preencha Configura√ß√µes e Nome do Cliente");

        showStatus(`‚è≥ Gerando site para ${nome}...`, "loading", true);

        // Monta Cr√©ditos
        const creditos = [];
        document.querySelectorAll('.cred-row').forEach(r => {
            const item = r.querySelector('.cr-item').value;
            const qtd = parseInt(r.querySelector('.cr-qtd').value);
            if(item) creditos.push({ item, qtd });
        });

        // Monta Objeto Config Cliente
        const dbAtual = montarObjetoDB();
        const configCliente = {
            ...dbAtual,
            cliente: {
                nome: nome,
                entrada: parseFloat(document.getElementById('cliEntrada').value)||0,
                incluirAlbum: document.getElementById('cliTemAlbum').value === 'sim',
                contrato: {
                    tamanho: document.getElementById('ctrTam').value,
                    qtdFotos: parseInt(document.getElementById('ctrQtd').value)||20,
                    valorTotal: parseFloat(document.getElementById('ctrValor').value)||0
                },
                creditos: creditos
            },
            fotos: document.getElementById('cliFotos').value.split('\n').filter(s=>s.trim().length>4),
            fluxo: {
                ...dbAtual.fluxo,
                pedirEdicao: document.getElementById('fluxoModo').value === 'venda'
            }
        };

        try {
            // Baixa modelo.html
            const tplReq = await fetch('modelo.html');
            if(!tplReq.ok) throw new Error("modelo.html n√£o encontrado localmente.");
            let html = await tplReq.text();

            // Injeta Config
            const script = `<script>window.NBV_CONFIG = ${JSON.stringify(configCliente, null, 2)};<\/script>`;
            html = html.replace('', script);

            // Upload
            const path = `clientes/${nome.replace(/\s+/g, '-').toLowerCase()}/index.html`;
            const url = await uploadToGithub(creds, path, html, `Site: ${nome}`);
            
            showStatus(`‚úÖ <b>SUCESSO!</b><br>Link: <a href="${url}" target="_blank" style="color:#064e3b">${url}</a>`, "success", true);

        } catch(e) {
            console.error(e);
            showStatus("‚ùå Falha: " + e.message, "error", true);
        }
    }

</script>
</body>
</html>
